# Security Vulnerability Fix Effort Report

**Generated:** 2026-01-28  
**Total Vulnerabilities:** 22  
**Packages Affected:** 11  

---

## Executive Summary

| Severity | Count | Fix Effort |
|----------|-------|------------|
| HIGH | 9 | Mixed - mostly simple version bumps |
| MODERATE | 9 | Simple version bumps |
| LOW | 4 | Simple version bump (aiohttp) |

**Estimated Total Fix Time:** 2-4 hours (assuming no breaking changes)  
**Risk Assessment:** 1 vulnerability has NO PATCH (ecdsa) - requires evaluation

---

## Detailed Vulnerability Analysis

### HIGH SEVERITY (P1) - 9 Vulnerabilities

#### 1. urllib3 (3 CVEs)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-g1n` |
| **CVEs** | CVE-2025-66418, CVE-2025-66471 |
| **Current Version** | 2.5.0 |
| **Patched Version** | 2.6.0 |
| **Vulnerability** | Unbounded decompression chain, streaming API issues |
| **CVSS** | 8.9 (High) |
| **Fix Effort** | üü¢ **LOW** - Minor version bump |
| **Code Changes** | None expected - internal fix |
| **Breaking Changes** | Unlikely |
| **Command** | `poetry add urllib3@^2.6.0` |

#### 2. python-multipart (1 CVE)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-eml` |
| **CVE** | CVE-2025-* (recent) |
| **Current Version** | 0.0.18 |
| **Patched Version** | TBD (check PyPI for latest) |
| **Vulnerability** | Arbitrary file write via non-default configuration |
| **Fix Effort** | üü° **MEDIUM** - Needs investigation |
| **Code Changes** | Review any custom multipart configuration |
| **Breaking Changes** | Possible if using non-default config |
| **Note** | Transitive dependency via FastAPI/Starlette |

#### 3. azure-core (1 CVE)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-847` |
| **CVE** | CVE-2025-* |
| **Current Version** | 1.36.0 |
| **Patched Version** | 1.38.0 |
| **Vulnerability** | Deserialization of untrusted data |
| **Fix Effort** | üü¢ **LOW** - Minor version bump |
| **Code Changes** | None expected |
| **Breaking Changes** | Unlikely |
| **Command** | `poetry add azure-core@^1.38.0` |

#### 4. starlette (2 CVEs)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-amx` |
| **CVEs** | CVE-2025-62727, CVE-2025-54121 |
| **Current Version** | 0.46.2 |
| **Patched Version** | 0.49.1 |
| **Vulnerability** | O(n¬≤) Range header DoS, multipart form DoS |
| **CVSS** | 7.5 (High), 5.3 (Medium) |
| **Fix Effort** | üü° **MEDIUM** - Multiple minor versions |
| **Code Changes** | Review any FileResponse usage |
| **Breaking Changes** | Possible - check changelog for 0.47-0.49 |
| **Note** | Transitive dependency via FastAPI |

#### 5. ecdsa (1 CVE) ‚ö†Ô∏è NO PATCH
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-d8f` |
| **CVE** | CVE-2024-23342 |
| **Current Version** | 0.19.1 |
| **Patched Version** | **NONE AVAILABLE** |
| **Vulnerability** | Minerva timing attack on P-256 |
| **CVSS** | 7.4 (High) |
| **Fix Effort** | üî¥ **HIGH** - Requires evaluation |
| **Options** | 1) Accept risk, 2) Replace with cryptography lib, 3) Remove if not needed |
| **Breaking Changes** | Depends on chosen approach |
| **Analysis Required** | Determine if ecdsa is directly used or transitive |

#### 6. aiohttp (8 CVEs - 1 High, 4 Moderate, 3 Low)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-92h` |
| **CVEs** | CVE-2025-69223 (zip bomb), +7 others |
| **Current Version** | 3.13.2 |
| **Patched Version** | 3.13.3 |
| **Vulnerability** | Zip bomb, DoS, request smuggling, cookie parser issues |
| **Fix Effort** | üü¢ **LOW** - Patch version bump |
| **Code Changes** | None expected |
| **Breaking Changes** | Unlikely (patch release) |
| **Command** | `poetry add aiohttp@^3.13.3` |

#### 7. pyasn1 (1 CVE)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-05f` |
| **CVE** | CVE-2026-23490 |
| **Current Version** | 0.6.1 |
| **Patched Version** | 0.6.2 |
| **Vulnerability** | DoS via malformed RELATIVE-OID data |
| **CVSS** | 7.5 (High) |
| **Fix Effort** | üü¢ **LOW** - Patch version bump |
| **Code Changes** | None expected |
| **Breaking Changes** | Unlikely |
| **Note** | Transitive dependency |

---

### MODERATE SEVERITY (P2) - 9 Vulnerabilities

#### 8. filelock (2 CVEs)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-r1g` |
| **CVEs** | CVE-2025-68146 (x2 - same root cause) |
| **Current Version** | 3.20.0 |
| **Patched Version** | 3.20.1 |
| **Vulnerability** | TOCTOU race condition, symlink attacks |
| **Fix Effort** | üü¢ **LOW** - Patch version bump |
| **Code Changes** | None expected |
| **Breaking Changes** | Unlikely |
| **Note** | Transitive dependency via virtualenv, poetry |

#### 9. fastapi-sso (1 CVE)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-dzs` |
| **CVE** | CVE-2025-14546 |
| **Current Version** | 0.16.0 |
| **Patched Version** | 0.19.0 |
| **Vulnerability** | CSRF through improper OAuth state parameter validation |
| **CVSS** | 6.3 (High Risk) |
| **Fix Effort** | üü° **MEDIUM** - Multiple minor versions |
| **Code Changes** | Review OAuth callback handling |
| **Breaking Changes** | Possible - check changelog |
| **Analysis** | If using SSO, verify state parameter handling |

#### 10. orjson (1 CVE) ‚úÖ LIKELY FIXED
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-n0r` |
| **CVE** | CVE-2024-27454 |
| **Current Version** | 3.11.4 |
| **Patched Version** | 3.9.15 |
| **Vulnerability** | Unbounded recursion in orjson.loads |
| **Fix Effort** | üü¢ **NONE** - Already patched |
| **Status** | **VERIFY AND CLOSE** - Current version > fix version |
| **Action** | Confirm fix is included, close Dependabot alert |

#### 11. PyNaCl (1 CVE)
| Field | Value |
|-------|-------|
| **Issue ID** | `fastworkflow-b2y` |
| **CVE** | CVE-2025-69277 |
| **Current Version** | 1.6.1 |
| **Patched Version** | 1.6.2 |
| **Vulnerability** | libsodium incomplete list of disallowed inputs |
| **CVSS** | 4.5 (Medium) |
| **Fix Effort** | üü¢ **LOW** - Patch version bump |
| **Code Changes** | None expected |
| **Breaking Changes** | Unlikely |
| **Note** | Only affects atypical custom cryptography use cases |

---

## Fix Strategy

### Phase 1: Quick Wins (30 min)
Patch version bumps with no expected breaking changes:

```bash
# Update poetry.lock with patched versions
poetry add aiohttp@^3.13.3
poetry add pyasn1@^0.6.2
poetry add filelock@^3.20.1
poetry add pynacl@^1.6.2
poetry add urllib3@^2.6.0
poetry add azure-core@^1.38.0

# Run tests to verify
pytest
```

### Phase 2: Minor Version Updates (1-2 hours)
Require changelog review for breaking changes:

```bash
# Review changelogs first
poetry add starlette@^0.49.1
poetry add fastapi-sso@^0.19.0

# Run full test suite
pytest --cov
```

### Phase 3: Investigation Required (1+ hour)

1. **python-multipart**: Check if newer version available, review configuration
2. **ecdsa**: Determine usage pattern and evaluate alternatives
3. **orjson**: Verify fix is included and dismiss Dependabot alert

---

## Code Change Summary

| Package | Code Changes Required |
|---------|----------------------|
| urllib3 | None |
| python-multipart | Review config if using non-default settings |
| azure-core | None |
| starlette | Review FileResponse usage |
| ecdsa | **Evaluation needed** - may need replacement |
| aiohttp | None |
| pyasn1 | None |
| filelock | None |
| fastapi-sso | Review OAuth callback handling |
| orjson | None (already fixed) |
| PyNaCl | None |

---

## Dependency Tree Impact

Several vulnerabilities are in **transitive dependencies**:

- `starlette` ‚Üí via `fastapi`
- `python-multipart` ‚Üí via `fastapi` ‚Üí `starlette`
- `pyasn1` ‚Üí via `cryptography` ‚Üí `python-jose`
- `filelock` ‚Üí via `virtualenv`/build tools
- `ecdsa` ‚Üí via `python-jose` (JWT library)

**Recommendation:** After updating direct dependencies, run `poetry lock --no-update` to refresh lock file, then `poetry update` for transitive deps.

---

## Risk Matrix

| Package | Exploitability | Impact | Patch Available | Priority |
|---------|---------------|--------|-----------------|----------|
| aiohttp | High (network) | DoS | ‚úÖ Yes | **URGENT** |
| urllib3 | High (network) | DoS | ‚úÖ Yes | **URGENT** |
| starlette | High (network) | DoS | ‚úÖ Yes | **URGENT** |
| ecdsa | Medium (timing) | Key leak | ‚ùå No | **EVALUATE** |
| fastapi-sso | Medium (CSRF) | Auth bypass | ‚úÖ Yes | HIGH |
| azure-core | Medium | RCE | ‚úÖ Yes | HIGH |
| python-multipart | Low (config) | File write | ‚ö†Ô∏è TBD | MEDIUM |
| pyasn1 | Low (data) | DoS | ‚úÖ Yes | MEDIUM |
| filelock | Low (local) | File corrupt | ‚úÖ Yes | LOW |
| PyNaCl | Low (crypto) | Validation | ‚úÖ Yes | LOW |
| orjson | N/A | N/A | ‚úÖ Fixed | CLOSE |

---

## Beads Issues Created

```
P1 (HIGH):
  fastworkflow-g1n - urllib3 (3 CVEs)
  fastworkflow-eml - python-multipart
  fastworkflow-847 - azure-core
  fastworkflow-amx - starlette (2 CVEs)
  fastworkflow-d8f - ecdsa (NO PATCH)
  fastworkflow-92h - aiohttp (8 CVEs)
  fastworkflow-05f - pyasn1

P2 (MODERATE):
  fastworkflow-r1g - filelock (2 CVEs)
  fastworkflow-dzs - fastapi-sso
  fastworkflow-n0r - orjson (VERIFY & CLOSE)
  fastworkflow-b2y - PyNaCl
```

---

## Next Steps

1. **Immediate**: Run Phase 1 updates (patch versions)
2. **This Week**: Complete Phase 2 updates with testing
3. **Evaluate**: Determine ecdsa usage and mitigation strategy
4. **Verify**: Confirm orjson is already fixed, dismiss alert
5. **Monitor**: Set up automated dependency scanning
